import{r as n,m as se,c as U,b as d,d as p,J as l,e as a,N as w,a8 as C,L as _,K as L,E as r,u as s,M as m,P as M,T as A,D as z,F as le,ad as oe,ae as re}from"./@vue-DsGlF1-j.js";import{x as ie,y as H,z as ne,A as ue,B as de,C as me,D as ce,q as pe,j as ve}from"./@firebase-CBgXa-9_.js";import{_ as fe,i as ge,a as T,b as G,c as _e,m as xe}from"./index-fh3STtDl.js";import{_ as he,a as ye,b as be,c as we,d as Ce}from"./SelectScrollDownButton-BK2d6S2D.js";import{E as ke,F as $e,J as Ve,M as De}from"./radix-vue-6Z8x3TUN.js";import{F as J}from"./vue-sonner-B2EpXGAv.js";import{_ as Ie}from"./AdminSidebar-DAKwD2Ft.js";import{_ as Ue,a as Te,b as Be,c as Ee,d as Le,e as Me,f as Ae,g as Se,h as Fe}from"./TagsInputItemText-sWmi6ADl.js";import{o as Pe}from"./@vueuse-H75eWtDf.js";import{Q as je}from"./@vueup-qMjKR5Ws.js";import"./idb-BXWtuYvb.js";import"./tslib-BGVaTf34.js";import"./class-variance-authority-Bb4qSo10.js";import"./clsx-B-dksMZM.js";import"./tailwind-merge-3VKOpVsw.js";import"./vue-router-CrvMPvpV.js";import"./firebase-BQhzl84B.js";import"./@heroicons-DH5_RU0z.js";import"./vuex--kc_uza-.js";import"./@unovis-B16_51NZ.js";import"./@emotion-Dz_S_Xyw.js";import"./stylis-YPZU7XtI.js";import"./d3-transition-fhQpLGwb.js";import"./d3-dispatch-kxCwF96_.js";import"./d3-timer-DdKHrDhs.js";import"./d3-interpolate-DY0Cqdkz.js";import"./d3-color-Ceo1QMNe.js";import"./d3-selection-DSeOx27A.js";import"./d3-ease-Ox4sgw_u.js";import"./d3-interpolate-path-CTc7ZuM7.js";import"./striptags-CDKagow6.js";import"./to-px-DReLD3CO.js";import"./parse-unit-3UrBcP19.js";import"./d3-array-BJvpcdQ_.js";import"./@juggle-C8OzoCMD.js";import"./d3-axis-Cf4shvhW.js";import"./d3-scale-A6k9qkjg.js";import"./internmap-BkD7Hj8s.js";import"./d3-format-CzD4bSOQ.js";import"./d3-time-format-COsUQkot.js";import"./d3-time-B8hJ2rEE.js";import"./d3-shape-D7Hvm6M3.js";import"./d3-path-CimkQT29.js";import"./throttle-debounce-BnOnwhtV.js";import"./embla-carousel-vue-CXHqejTr.js";import"./embla-carousel-reactive-utils-DkegjUUZ.js";import"./embla-carousel-QtEXB4oT.js";import"./embla-carousel-autoplay-0OO14Ffu.js";import"./@radix-icons-C7iqcNif.js";import"./vuex-persistedstate-D4njCX8q.js";import"./maska-Cp-LWreF.js";import"./@internationalized-D5LszBdy.js";import"./@swc-BOtJyCjG.js";import"./@floating-ui-B6PpBHZy.js";import"./quill-delta-COPIFlMW.js";import"./fast-diff-DNDSwfiB.js";import"./lodash.clonedeep-CrPEM4m0.js";import"./lodash.isequal-CemT60YI.js";const k=$=>(oe("data-v-d4f5976c"),$=$(),re(),$),Ne={class:"bg-gray-100 min-h-screen flex ml-16"},Re={class:"flex flex-col flex-1 px-4 py-6"},ze=k(()=>a("div",{class:"flex items-center justify-between mb-6"},[a("h1",{class:"text-3xl font-semibold text-gray-700"},"Learning Management System")],-1)),He={class:"relative flex-1 bg-white rounded-lg shadow-md p-4 backdrop-blur-sm mx-auto max-w-5xl"},Ge=k(()=>a("h2",{class:"text-xl font-semibold text-gray-700 mb-4"},"Add New Course",-1)),Je={class:"flex space-x-4"},qe={class:"w-1/3"},Ke=k(()=>a("label",{class:"block text-sm font-medium"},"Course Image",-1)),We={key:0,class:"space-y-1 text-center mx-6 mt-5 mb-6"},Oe=k(()=>a("svg",{class:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true"},[a("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),Qe={class:"flex text-sm text-gray-600"},Ze=k(()=>a("p",{class:"text-xs font-normal text-gray-500"},[a("a",{class:"font-medium text-indigo-600"},"Upload a file"),m(" or drag and drop JPG, JPEG, PNG, WEBP up to 5MB ")],-1)),Xe={key:1,class:"relative w-full h-full"},Ye=["src"],et={key:0,class:"text-xs text-red-500 mt-1"},tt={class:"flex-1"},at={class:"text-xs text-gray-500 mt-1"},st={key:0,class:"text-xs text-red-500 mt-1"},lt={key:1,class:"text-xs text-red-500 mt-1"},ot={class:"flex space-x-4"},rt={class:"flex-1"},it={class:"flex gap-2 flex-wrap items-center px-3"},nt={class:"w-1/3"},ut={class:"flex items-center space-x-2"},dt={class:"flex justify-end"},mt={__name:"AddCourse",setup($){const v=n(""),x=n(""),f=n(null),g=n(null),V=n(""),u=n([]),h=n(!1),c=n(""),i=n({value:1,unit:"Days"}),y=n(!0),B=n(!1),D=n(!1),S=n(!1),E=ie(ge,"learningManagementSystem/tempestStudios/courses"),F=n([]);se(async()=>{const o=await H(E),e=[];o.forEach(t=>{const b=t.data().courseCategory;Array.isArray(b)&&e.push(...b)}),F.value=Array.from(new Set(e))});const q=U(()=>F.value.filter(o=>!u.value.includes(o))),K=o=>{u.value.push(o.toLowerCase()),c.value="",h.value=!1},W=()=>{c.value.trim()!==""&&!u.value.includes(c.value.toLowerCase())&&(u.value.push(c.value.trim().toLowerCase()),c.value="")};Pe(()=>{h.value=!1});const O=o=>o.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,(e,t)=>+e==0?"":t===0?e.toLowerCase():e.toUpperCase()),P=o=>o.charAt(0).toUpperCase()+o.slice(1),Q=async()=>{const o=/^(?!.*\s$)(?!\s)[a-zA-Z0-9- ]{4,}$/;if(y.value=o.test(v.value),y.value){const e=ne(E,ue("title","==",v.value)),t=await H(e);B.value=!t.empty}},I=U(()=>O(v.value)),j=o=>{const e=o.target.files[0];if(e&&e.size<=5*1024*1024&&["image/jpeg","image/png","image/webp"].includes(e.type)){const t=new FileReader;t.onload=b=>{g.value=b.target.result},t.readAsDataURL(e),V.value=null,f.value=e}else V.value="Invalid file. Please upload a JPG, JPEG, PNG, or WEBP file up to 5MB."},Z=o=>{const e=o.dataTransfer.files[0];j({target:{files:[e]}})},X=()=>{document.getElementById("file-upload-hidden").click()},Y=()=>{g.value=null,f.value=null,document.getElementById("file-upload-hidden").value=null},ee=[{label:"Half-Days",value:"Half-Days"},{label:"Days",value:"Days"},{label:"Weeks",value:"Weeks"},{label:"Months",value:"Months"}],te=()=>{i.value.value=i.value.value.replace(/[^0-9]/g,""),i.value.value===""&&(i.value.value=1)},N=U(()=>i.value.value!==""&&parseInt(i.value.value)>0),R=U(()=>y.value&&!B.value&&x.value.trim()!==""&&f.value!==null&&u.value.length>0&&N.value),ae=async()=>{if(!R.value)return;let o="";if(f.value){const t=de(xe,`company-specific/tempest-studios/learning/courses/images/${I.value}`);await me(t,f.value),o=await ce(t)}const e={title:v.value,description:x.value,image:o,length:{value:parseInt(i.value.value),unit:i.value.unit},courseCategory:u.value,courseId:I.value};try{await pe(ve(E,I.value),e),v.value="",x.value="",f.value=null,g.value=null,u.value=[],i.value={value:1,unit:"Days"},J.success("Course added successfully!")}catch(t){console.error("Error adding document: ",t),J.error("Failed to add course. Please try again.")}};return(o,e)=>(d(),p("div",Ne,[l(Ie,{class:"shadow-2xl"}),a("div",Re,[ze,a("div",He,[Ge,a("form",{onSubmit:w(ae,["prevent"]),class:"space-y-4"},[a("div",Je,[a("div",qe,[Ke,a("div",{class:C(["mt-1 flex justify-center items-center border-2 border-gray-300 border-dashed rounded-md cursor-pointer overflow-hidden relative",{"border-none":g.value}]),onDragover:e[2]||(e[2]=w(()=>{},["prevent"])),onDrop:w(Z,["prevent"]),onClick:X},[g.value?(d(),p("div",Xe,[a("img",{src:g.value,alt:"Course image preview",class:"w-full h-full object-cover rounded-md"},null,8,Ye),a("div",{class:C(["absolute top-0 right-0 bg-black text-white w-6 h-6 rounded-full flex items-center justify-center cursor-pointer",{"bg-red-500":o.isRemoveHover}]),onClick:w(Y,["stop"]),onMouseover:e[0]||(e[0]=t=>o.isRemoveHover=!0),onMouseleave:e[1]||(e[1]=t=>o.isRemoveHover=!1)}," X ",34)])):(d(),p("div",We,[Oe,a("div",Qe,[Ze,a("input",{id:"file-upload-hidden",ref:"fileInput",name:"file-upload-hidden",type:"file",class:"sr-only",onChange:j,accept:".jpg,.jpeg,.png,.webp"},null,544)])]))],34),V.value?(d(),p("p",et,_(V.value),1)):L("v-if",!0)]),a("div",tt,[l(s(T),{class:"block text-sm font-medium"},{default:r(()=>[m("Course Title")]),_:1}),l(s(G),{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=t=>v.value=t),type:"text",class:C(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",{"focus:ring-red-500 border-red-500":D.value&&!y.value}]),required:"",onInput:Q,onBlur:e[4]||(e[4]=t=>D.value=!0)},null,8,["modelValue","class"]),a("p",at,"Course ID: "+_(I.value),1),D.value&&!y.value?(d(),p("p",st," Title must be at least 4 characters long and contain only letters, numbers, and dashes. ")):L("v-if",!0),D.value&&B.value?(d(),p("p",lt," This course title is already taken. ")):L("v-if",!0)])]),a("div",null,[l(s(T),{class:"block text-sm font-medium mb-2"},{default:r(()=>[m("Description")]),_:1}),l(s(je),{content:x.value,"onUpdate:content":e[5]||(e[5]=t=>x.value=t),toolbar:"essential",contentType:"html",class:"rows-4 rounded-md"},null,8,["content"])]),a("div",ot,[a("div",rt,[l(s(T),{class:"block text-sm mb-1 font-medium"},{default:r(()=>[m("Course Categories")]),_:1}),l(s(Fe),{modelValue:u.value,"onUpdate:modelValue":e[10]||(e[10]=t=>u.value=t),class:"px-0 gap-0 w-full"},{default:r(()=>[a("div",it,[(d(!0),p(M,null,A(u.value,t=>(d(),z(s(Be),{key:t,value:t},{default:r(()=>[l(s(Ue),null,{default:r(()=>[m(_(P(t)),1)]),_:2},1024),l(s(Te))]),_:2},1032,["value"]))),128))]),l(s(ke),{open:h.value,"onUpdate:open":e[7]||(e[7]=t=>h.value=t),searchTerm:c.value,"onUpdate:searchTerm":e[8]||(e[8]=t=>c.value=t),class:"w-full",onClickOutside:e[9]||(e[9]=t=>h.value=!1)},{default:r(()=>[l(s($e),{"as-child":""},{default:r(()=>[l(s(Ve),{placeholder:"Select Category...","as-child":""},{default:r(()=>[l(s(Ee),{class:C(["w-full px-3",u.value.length>0?"mt-2":""]),onKeydown:le(w(W,["prevent"]),["enter"]),modelValue:c.value,"onUpdate:modelValue":e[6]||(e[6]=t=>c.value=t)},null,8,["class","onKeydown","modelValue"])]),_:1})]),_:1}),l(s(De),null,{default:r(()=>[l(s(Le),{position:"popper",class:"w-[--radix-popper-anchor-width] rounded-md mt-2 border bg-popover text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2"},{default:r(()=>[l(s(Me)),l(s(Ae),null,{default:r(()=>[(d(!0),p(M,null,A(q.value,t=>(d(),z(s(Se),{key:t,value:t,onSelect:b=>K(t)},{default:r(()=>[m(_(P(t)),1)]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["open","searchTerm"])]),_:1},8,["modelValue"])]),a("div",nt,[l(s(T),{class:"block text-sm mb-1 font-medium"},{default:r(()=>[m("Course Length")]),_:1}),a("div",ut,[l(s(G),{modelValue:i.value.value,"onUpdate:modelValue":e[11]||(e[11]=t=>i.value.value=t),type:"number",class:C(["w-[60px] h-[34px]",{"focus:ring-red-500 border-red-500":S.value&&!N.value}]),onInput:te,onBlur:e[12]||(e[12]=t=>S.value=!0)},null,8,["modelValue","class"]),l(s(Ce),{modelValue:i.value.unit,"onUpdate:modelValue":e[13]||(e[13]=t=>i.value.unit=t)},{default:r(()=>[l(s(he),null,{default:r(()=>[l(s(ye),{placeholder:"Filter by course type",class:"text-gray-500"},{default:r(()=>[m(_(i.value.unit.charAt(0).toUpperCase()+i.value.unit.slice(1)),1)]),_:1})]),_:1}),l(s(be),null,{default:r(()=>[(d(),p(M,null,A(ee,t=>l(s(we),{key:t.value,value:t.value},{default:r(()=>[m(_(t.label),1)]),_:2},1032,["value"])),64))]),_:1})]),_:1},8,["modelValue"])])])]),a("div",dt,[l(s(_e),{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",disabled:!R.value},{default:r(()=>[m(" Add Course ")]),_:1},8,["disabled"])])],32)])])]))}},_a=fe(mt,[["__scopeId","data-v-d4f5976c"]]);export{_a as default};
