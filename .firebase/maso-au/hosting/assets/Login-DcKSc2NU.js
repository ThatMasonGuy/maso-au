import{r as h,z as V,a9 as D,d as N,e as o,D as a,v as n,I as b,u as l,ae as E,K as c,b as y}from"./@vue-B4Dw-v2v.js";import{s as m,f as A,r as d,e as _,d as g,a as x,b as k}from"./index-Co61aMdR.js";import{d as S,k as G,G as P,l as q,h as I,j as U,m as L,n as j,p as F}from"./@firebase-DkCrMZ0w.js";import{F as f}from"./vue-sonner-AtLNa_tU.js";import"./radix-vue-BCZIVvbu.js";import"./@floating-ui-CUlQowRW.js";import"./class-variance-authority-Bb4qSo10.js";import"./clsx-B-dksMZM.js";import"./tailwind-merge-3VKOpVsw.js";import"./vaul-vue-H4ZVHYe6.js";import"./vue-router-DSg-0K4U.js";import"./@heroicons-D-uQ7Bf0.js";import"./firebase-BfrZvKqU.js";import"./jspdf-CVWcoUId.js";import"./@babel-BsCcpEdk.js";import"./fflate-Cf-_J6lE.js";import"./@vueuse-BtIaJPtC.js";import"./@radix-icons-DYXLExGV.js";import"./vuex-CiS5vxGU.js";import"./vuex-persistedstate-D4njCX8q.js";import"./idb-BXWtuYvb.js";import"./tslib-BGVaTf34.js";const $=S();G($,"createUser");const z=new P;q(_,async t=>{if(t)try{const e=await t.getIdToken();m.commit("setAuthToken",e);const s=I(A,"users",t.uid);(await U(s)).exists()||await L(s,{firstName:t.firstName||"",lastName:t.lastName||"",userName:t.userName||"",emailAddress:t.emailAddress,phoneNumber:t.phoneNumber||"",avatarUrl:t.photoURL||""}),m.commit("setUser",{uid:t.uid,firstName:t.firstName||"",lastName:t.lastName||"",userName:t.userName||"",emailAddress:t.emailAddress,phoneNumber:t.phoneNumber||"",avatarUrl:t.photoURL||""});const r=d.currentRoute.value;r.meta.requiresAuth&&r.meta.requiresAuth&&!t&&d.push("/login")}catch(e){console.error("Error in onAuthStateChanged:",e)}else m.commit("clearAuthToken"),m.commit("clearUser"),d.currentRoute.value.meta.requiresAuth&&d.push("/login")});const B=async(t,e)=>{try{const r=await(await j(_,t,e)).user.getIdToken();m.commit("setAuthToken",r),d.push("/home")}catch(s){throw console.error("Error signing in:",s),s}},M=async()=>{try{const e=(await F(_,z)).user,s=await e.getIdToken();m.commit("setAuthToken",s);const i=I(A,"users",e.uid);(await U(i)).exists()||await L(i,{firstName:e.firstName||"",lastName:e.lastName||"",userName:e.userName||"",emailAddress:e.emailAddress,phoneNumber:e.phoneNumber||"",avatarUrl:e.photoURL||""}),m.commit("setUser",{uid:e.uid,firstName:e.firstName||"",lastName:e.lastName||"",userName:e.userName||"",emailAddress:e.emailAddress,phoneNumber:e.phoneNumber||"",avatarUrl:e.photoURL||""}),d.push("/home")}catch(t){throw console.error("Error signing in with Google:",t),t}},W={class:"w-full lg:grid lg:min-h-screen lg:grid-cols-2 h-screen"},H={class:"flex flex-col items-center justify-center py-12 px-4 mx-auto"},K={class:"mx-auto grid w-[350px] gap-6"},J=o("div",{class:"grid gap-2 text-center"},[o("h1",{class:"text-3xl font-bold mb-6"},"Login"),o("p",{class:"text-balance text-muted-foreground"}," Enter your email below to login to your account ")],-1),O={class:"grid gap-2"},Q={class:"grid gap-2"},X={class:"flex items-center"},Y=o("a",{href:"/forgot-password",class:"ml-auto inline-block text-sm underline"}," Forgot your password? ",-1),Z=o("div",{class:"mt-4 text-center text-sm"},[c(" Don't have an account? "),o("a",{href:"/signup",class:"underline"}," Sign up ")],-1),ee={class:"bg-gray-500 lg:block relative overflow-hidden"},te=["src"],oe=["src"],Ae={__name:"Login",setup(t){const e=h("https://source.unsplash.com/random/1"),s=h("https://source.unsplash.com/random/2"),i=h(""),r=h(""),C=()=>{s.value=`https://source.unsplash.com/random/${Date.now()}`;const u=e.value;e.value=s.value,s.value=u};V(()=>{setInterval(C,8e3)});const R=async()=>{try{await B(i.value,r.value),f.success("Login successful!")}catch(u){f.error(u.message)}},T=async()=>{try{await M(),f.success("Login successful!")}catch(u){f.error(u.message)}};return(u,p)=>{const w=D("router-link");return y(),N("div",W,[o("div",H,[a(w,{to:"/"},{default:n(()=>[a(l(g),{href:"/",class:"absolute top-2 left-2 z-20"},{default:n(()=>[c("Return Home")]),_:1})]),_:1}),a(w,{to:"/"},{default:n(()=>[a(l(g),{href:"/",class:"absolute top-2 right-2 z-20"},{default:n(()=>[c("Dark Mode")]),_:1})]),_:1}),o("div",K,[J,o("form",{class:"grid gap-4",onSubmit:b(R,["prevent"])},[o("div",O,[a(l(x),{for:"email"},{default:n(()=>[c("Email")]),_:1}),a(l(k),{id:"email",type:"email",placeholder:"example@gmail.com",autocomplete:"email",required:"",modelValue:i.value,"onUpdate:modelValue":p[0]||(p[0]=v=>i.value=v)},null,8,["modelValue"])]),o("div",Q,[o("div",X,[a(l(x),{for:"password"},{default:n(()=>[c("Password")]),_:1}),Y]),a(l(k),{id:"password",type:"password",placeholder:"Password",autocomplete:"current-password",required:"",modelValue:r.value,"onUpdate:modelValue":p[1]||(p[1]=v=>r.value=v)},null,8,["modelValue"])]),a(l(g),{type:"submit",class:"w-full"},{default:n(()=>[c(" Login ")]),_:1}),a(l(g),{variant:"outline",class:"w-full",onClick:b(T,["prevent"])},{default:n(()=>[c(" Login with Google ")]),_:1})],32),Z])]),o("div",ee,[a(E,{name:"fade",mode:"in-out","enter-active-class":"transition-opacity duration-1000","leave-active-class":"transition-opacity duration-1000","enter-from-class":"opacity-0","leave-to-class":"opacity-0"},{default:n(()=>[(y(),N("img",{key:e.value,src:e.value,alt:"Current Image",class:"object-cover w-full h-full absolute inset-0"},null,8,te))]),_:1}),o("img",{src:s.value,alt:"Next Image",class:"object-cover w-full h-full absolute inset-0 opacity-0"},null,8,oe)])])}}};export{Ae as default};
