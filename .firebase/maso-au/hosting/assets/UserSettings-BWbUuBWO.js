import{r as p,m as F,b as c,d as f,J as t,e as o,u as s,E as r,P as M,T as B,N,K as L,M as m,L as P,D as j,a8 as k}from"./@vue-Cc5W6W03.js";import{u as q}from"./vuex-F4EPD-zj.js";import{k as I,j as C,u as O,L as T,M as z,N as J}from"./@firebase-7dTA5crF.js";import{f as h,i as V,m as K,c as _,a as g,b}from"./index-B_BK-3TZ.js";import{a as W,b as Y,c as G,_ as H}from"./DialogContent-BZj_CcQm.js";import{a as Q,_ as R}from"./AdminSidebar-Dkji6bOi.js";import{F as w}from"./vue-sonner-tOpOM8Nc.js";import"./idb-BXWtuYvb.js";import"./tslib-BGVaTf34.js";import"./radix-vue-g1r_MIx6.js";import"./@internationalized-D5LszBdy.js";import"./@swc-BOtJyCjG.js";import"./@floating-ui-rhRhKn_Q.js";import"./class-variance-authority-Bb4qSo10.js";import"./clsx-B-dksMZM.js";import"./tailwind-merge-3VKOpVsw.js";import"./vue-router-Yx5yAxkf.js";import"./firebase-wUg9X9TS.js";import"./@heroicons-D7NO6Ex3.js";import"./@unovis-B91CR5fh.js";import"./@emotion-Dz_S_Xyw.js";import"./stylis-YPZU7XtI.js";import"./d3-transition-fhQpLGwb.js";import"./d3-dispatch-kxCwF96_.js";import"./d3-timer-DdKHrDhs.js";import"./d3-interpolate-DY0Cqdkz.js";import"./d3-color-Ceo1QMNe.js";import"./d3-selection-DSeOx27A.js";import"./d3-ease-Ox4sgw_u.js";import"./d3-interpolate-path-CTc7ZuM7.js";import"./striptags-PW3Qp06w.js";import"./@excalidraw-_WJHnpoj.js";import"./react-D1sI5Brr.js";import"./react-dom-9hUPJye5.js";import"./scheduler-CzFDRTuY.js";import"./to-px-DReLD3CO.js";import"./parse-unit-3UrBcP19.js";import"./d3-array-BJvpcdQ_.js";import"./@juggle-C8OzoCMD.js";import"./d3-axis-Cf4shvhW.js";import"./d3-scale-A6k9qkjg.js";import"./internmap-BkD7Hj8s.js";import"./d3-format-CzD4bSOQ.js";import"./d3-time-format-COsUQkot.js";import"./d3-time-B8hJ2rEE.js";import"./d3-shape-D7Hvm6M3.js";import"./d3-path-CimkQT29.js";import"./throttle-debounce-BnOnwhtV.js";import"./embla-carousel-vue-Dcvag-wm.js";import"./embla-carousel-reactive-utils-DkegjUUZ.js";import"./embla-carousel-QtEXB4oT.js";import"./@vueuse-CclTXppY.js";import"./embla-carousel-autoplay-0OO14Ffu.js";import"./@radix-icons-Ce5A0lVI.js";import"./vuex-persistedstate-D4njCX8q.js";import"./maska-Cp-LWreF.js";const X={class:"bg-gray-100 min-h-screen p-4 md:p-8 ml-16"},Z=o("h1",{class:"text-3xl font-bold mb-6"},"My Settings",-1),ee={key:0,class:"text-center"},ae=o("div",{class:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900 mx-auto"},null,-1),te=[ae],se={key:1,class:"bg-white shadow-md rounded-lg p-6"},re={class:"flex justify-between items-center mb-6"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},le={key:1,class:"bg-gray-100 p-2 rounded"},ie={class:"mt-6 flex justify-between"},de={class:"space-y-4"},ca={__name:"UserSettings",setup(ne){q();const l=p({}),y=p(!0),v=p(!1),u=p(!1),i=p({currentPassword:"",newPassword:"",confirmPassword:""}),U={firstName:{label:"First Name"},lastName:{label:"Last Name"},userName:{label:"Username"},emailAddress:{label:"Email",type:"email"},phoneNumber:{label:"Phone Number",type:"tel"},country:{label:"Country"},createdAt:{label:"Created At",type:"datetime-local"},updatedAt:{label:"Updated At",type:"datetime-local"},isAdmin:{label:"Admin Status"}};F(async()=>{await A()});const A=async()=>{try{const e=h.currentUser;if(e){const a=await I(C(V,"users",e.uid));a.exists()&&(l.value=a.data(),l.value.createdAt=new Date(l.value.createdAt.seconds*1e3).toISOString().slice(0,16),l.value.updatedAt=new Date(l.value.updatedAt.seconds*1e3).toISOString().slice(0,16))}}catch(e){console.error("Error fetching user data:",e),w.error("Failed to load user data")}finally{y.value=!1}},S=()=>{u.value=!u.value,u.value||A()},x=async()=>{try{const e=h.currentUser;if(e&&u.value){const a={...l.value,updatedAt:new Date};delete a.isAdmin,await O(C(V,"users",e.uid),a),w.success("Settings updated successfully"),u.value=!1}}catch(e){console.error("Error updating settings:",e),w.error("Failed to update settings")}},D=async()=>{try{if(i.value.newPassword!==i.value.confirmPassword)throw new Error("New passwords do not match");const e=h.currentUser,a=T.credential(e.email,i.value.currentPassword);await z(e,a),await J(e,i.value.newPassword),w.success("Password changed successfully"),v.value=!1,i.value={currentPassword:"",newPassword:"",confirmPassword:""}}catch(e){console.error("Error changing password:",e),w.error(e.message||"Failed to change password")}},E=e=>(e.firstName[0]+e.lastName[0]).toUpperCase();return(e,a)=>(c(),f("div",X,[t(Q),Z,y.value?(c(),f("div",ee,te)):(c(),f("div",se,[o("div",re,[t(s(K),{src:l.value.avatarUrl,fallback:E(l.value),class:"w-20 h-20"},null,8,["src","fallback"]),t(s(_),{onClick:S,variant:u.value?"default":"outline"},{default:r(()=>[m(P(u.value?"Cancel":"Edit"),1)]),_:1},8,["variant"])]),o("form",{onSubmit:N(x,["prevent"])},[o("div",oe,[(c(),f(M,null,B(U,(d,n)=>o("div",{key:n},[t(s(g),{for:n},{default:r(()=>[m(P(d.label),1)]),_:2},1032,["for"]),n!=="isAdmin"?(c(),j(s(b),{key:0,id:n,modelValue:l.value[n],"onUpdate:modelValue":$=>l.value[n]=$,type:d.type||"text",readonly:!u.value||n==="createdAt"||n==="updatedAt",class:k({"bg-gray-100":!u.value||n==="createdAt"||n==="updatedAt"})},null,8,["id","modelValue","onUpdate:modelValue","type","readonly","class"])):(c(),f("div",le,P(l.value[n]?"Yes":"No"),1))])),64))]),o("div",ie,[t(s(_),{type:"submit",disabled:!u.value},{default:r(()=>[m("Save Changes")]),_:1},8,["disabled"]),t(s(_),{type:"button",variant:"outline",onClick:a[0]||(a[0]=d=>v.value=!0)},{default:r(()=>[m("Change Password")]),_:1})])],32)])),L(" Change Password Modal "),t(s(H),{open:v.value,"onUpdate:open":a[4]||(a[4]=d=>v.value=d)},{default:r(()=>[t(s(W),null,{default:r(()=>[t(s(Y),null,{default:r(()=>[t(s(G),null,{default:r(()=>[m("Change Password")]),_:1})]),_:1}),o("form",{onSubmit:N(D,["prevent"])},[o("div",de,[o("div",null,[t(s(g),{for:"currentPassword"},{default:r(()=>[m("Current Password")]),_:1}),t(s(b),{id:"currentPassword",modelValue:i.value.currentPassword,"onUpdate:modelValue":a[1]||(a[1]=d=>i.value.currentPassword=d),type:"password",required:""},null,8,["modelValue"])]),o("div",null,[t(s(g),{for:"newPassword"},{default:r(()=>[m("New Password")]),_:1}),t(s(b),{id:"newPassword",modelValue:i.value.newPassword,"onUpdate:modelValue":a[2]||(a[2]=d=>i.value.newPassword=d),type:"password",required:""},null,8,["modelValue"])]),o("div",null,[t(s(g),{for:"confirmPassword"},{default:r(()=>[m("Confirm New Password")]),_:1}),t(s(b),{id:"confirmPassword",modelValue:i.value.confirmPassword,"onUpdate:modelValue":a[3]||(a[3]=d=>i.value.confirmPassword=d),type:"password",required:""},null,8,["modelValue"])])]),t(s(R),{class:"mt-4"},{default:r(()=>[t(s(_),{type:"submit"},{default:r(()=>[m("Change Password")]),_:1})]),_:1})],32)]),_:1})]),_:1},8,["open"])]))}};export{ca as default};
